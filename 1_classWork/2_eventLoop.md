## 🔁 Что такое Event Loop простыми словами

**JavaScript работает в одном потоке.** Это значит, что он может делать **только одну вещь в конкретный момент времени** — например, выполнять цикл, слушать клик или считать числа.

Но… тогда как он "одновременно":

- ждёт ответа с сервера (fetch),

- анимацию делает,

- и не зависает?

**Ответ: Event Loop.** Это механизм, который **управляет очередью задач** и даёт JavaScript возможность выполнять асинхронные действия, не блокируя основной поток.

---

## 🧠 Основные понятия

|Термин|Что это|
|-|-|
|Call Stack|Стек вызовов. Код, который исполняется прямо сейчас|
|Web APIs|Внешние "службы" браузера (setTimeout, fetch и т.п.)|
|Callback Queue|Очередь функций, ожидающих выполнения|
|Event Loop|Механизм, который следит: «Пусто ли в стеке?»|

---

## 📊 Как это работает (по шагам)

Представь, что JS получил такой код:

```JavaScript
console.log('1');

setTimeout(() => {
  console.log('2');
}, 0);

console.log('3');
```


### Что произойдёт:

1. `console.log('1')` — попал в стек, вывел `1`, ушёл из стека.

2. `setTimeout(...)` — уходит в Web API, браузер ставит таймер (0 мс).

3. `console.log('3')` — в стек, выводит `3`, стек снова пуст.

4. Таймер 0 мс закончился — callback (`console.log('2')`) кладётся в **Callback Queue**.

5. **Event Loop** замечает, что стек пуст — берёт задачу из очереди → `console.log('2')` попадает в стек и выполняется.

✅ Итог в консоли:

```JavaScript
1  
3  
2
```


---

## 🧪 Визуальный пример (можешь вставить в `main.js`):

```JavaScript
console.log("Start");

setTimeout(() => {
  console.log("Timeout");
}, 0);

Promise.resolve().then(() => {
  console.log("Promise");
});

console.log("End");
```


👉 **Результат:**

```JavaScript
Start
End
Promise
Timeout
```


🔍 Почему?

- `Promise.then()` идёт в **микрозадачи (microtasks queue)** — она **выполняется раньше**.

- `setTimeout` — в **макрозадачи (callback queue)**.

---

## 📌 Что нужно запомнить:

- Call Stack — текущие задачи.

- Event Loop — оркестратор, следит за очередями.

- Microtask queue (например, `.then`) важнее, чем macrotask (например, `setTimeout`).

- Даже `setTimeout(fn, 0)` — не выполняется мгновенно.

---

## 🧠 Хочешь потренироваться?

Вот простая, но полезная задача на **Event Loop**, идеально подходящая для джуна:

---

### 📘 Задача: **Порядок вывода**

```JavaScript
console.log("A");

setTimeout(() => {
  console.log("B");
}, 0);

Promise.resolve().then(() => {
  console.log("C");
});

console.log("D");
```


---

### 🧠 Твоя цель:

6. **Предсказать**, в каком порядке выведутся буквы в консоль.

7. **Объяснить**, почему именно так происходит — опираясь на знания об:

  - Call Stack

  - Microtasks (Promises)

  - Macrotasks (setTimeout)

  - Event Loop

---

### ✅ Ожидаемые ответы:

- Что выведется в консоли?

- Почему `C` появляется раньше `B`, даже если `setTimeout(..., 0)`?

---

Если решишь — можешь скинуть сюда свои мысли, и я помогу проверить или объяснить подробнее. Готов? 😊

Отличный разбор! Ты движешься в правильном направлении 💪 Давай подытожим и немного уточним, чтобы закрепить понимание:

---

## ✅ Что происходит пошагово:

Вот твой код ещё раз:

```JavaScript
console.log("A");

setTimeout(() => {
  console.log("B");
}, 0);

Promise.resolve().then(() => {
  console.log("C");
});

console.log("D");
```


---

### 🟩 1. Сначала запускается **Call Stack**:

```JavaScript
console.log("A"); // сразу выводится => A
```


---

### 🟩 2. Затем:

```JavaScript
setTimeout(() => { console.log("B"); }, 0);
```


- `setTimeout` уходит в **Web APIs**

- После задержки (0 мс) **callback ставится в очередь Macrotasks**

---

### 🟩 3. Потом:

```JavaScript
Promise.resolve().then(() => { console.log("C"); });
```


- `then(...)` уходит в очередь **Microtasks** — они приоритетнее!

---

### 🟩 4. Далее:

```JavaScript
console.log("D"); // сразу выводится => D
```


---

### 🔁 Event Loop начинает работу:

- ✅ **Сначала** выполняются **Microtasks** (все, что в `.then()` и `queueMicrotask`)
👉 выводится `C`

- ✅ Потом берётся первая **Macrotask** из очереди (callback от `setTimeout`)
👉 выводится `B`

---

## 🎯 Итоговый порядок в консоли:

```JavaScript
A
D
C
B
```


---

## 📌 Итого:

- `console.log("A")` → сразу

- `setTimeout(..., 0)` → **Macrotask**

- `Promise.resolve().then(...)` → **Microtask**

- `console.log("D")` → сразу

- Event loop → сначала Microtask → потом Macrotask

---

Если хочешь — могу дать ещё одну похожую задачку с `setTimeout`, `Promise`, `async/await`, чтобы закрепить. Хочешь?

